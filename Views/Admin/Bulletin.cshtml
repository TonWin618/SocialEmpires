@using Microsoft.AspNetCore.Mvc.Localization
@using System.Text
@using SocialEmpires.Models.PlayerSaves
@inject IViewLocalizer localizer
@{
    Layout = "_AdminLayout";
    ViewData["Title"] = localizer["Bulletin"];
}

<div class="row justify-content-md-center">
    <div class="col-8">
        <form asp-action="PublishBulletin" method="post">
            <div>
                <textarea id="tiny" name="htmlContent"></textarea>
            </div>
            <div class="d-flex justify-content-end align-items-center mt-3">
                <div class="d-flex justify-content-end align-items-center">
                    <input type="number" class="form-control" id="days" placeholder="0">@localizer["Days"]
                    <input type="number" class="form-control" id="hours" placeholder="0">@localizer["Hours"]
                    <input type="number" class="form-control" id="minutes" placeholder="0">@localizer["Minutes"]
                    <input type="number" class="form-control" id="seconds" placeholder="0">@localizer["Seconds"]
                </div>
                <button id="publishButton" type="submit" class="btn btn-primary ms-5">@localizer["Publish"]</button>
            </div>
        </form>
    </div>
</div>

<script src="~/js/tinymce/tinymce.min.js"></script>
<script src="~/js/signalr/dist/browser/signalr.js"></script>
<script>
    const browserLanguage = navigator.language || navigator.userLanguage;

    tinymce.init({
        selector: 'textarea#tiny',
        promotion: false,
        branding: false,
        language: browserLanguage.replace("-", "_"),
        menubar: false,
        toolbar: 'styleselect | bold italic underline fontsize | forecolor backcolor | blocks alignleft aligncenter bullist numlist outdent indent | hr',
        forced_root_block: 'div'
    });

    var connection = new signalR.HubConnectionBuilder().withUrl("/BulletinHub").build();

    connection.start().then()
        .catch(function (err) {
            console.error(err.toString());
        });
</script>